// File: Backend/services/live-streaming-service/prisma/schema.prisma (MUKAMMAL AUR FINAL CODE)

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// User model ko clerkId ke sath update kiya gaya hai
model User {
  id      String       @id @default(cuid()) // Hum ab CUID istemal karenge
  clerkId String       @unique // Yeh Clerk se aane wali user ID hai
  streams LiveStream[]
}

model LiveStream {
  id          String  @id @default(cuid())
  title       String
  description String?

  streamKey   String @unique
  playbackId  String @unique
  muxStreamId String @unique

  isLive Boolean @default(false)

  // Relation ab bilkul sahi hai
  userId String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
